<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="https://libs.cartocdn.com/cartodb.js/v3/3.15/themes/css/cartodb.css" />
</head>

<body class="data-page">
  <!-- include cartodb.js library -->
  <script src="https://libs.cartocdn.com/cartodb.js/v3/3.15/cartodb.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>
  <script>
    function numberWithCommas(x) {
      return x.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ",");
    }

    function setEstmiatedActiveCases(value) {
      window.ReactNativeWebView.postMessage(JSON.stringify({
        type: 'setEstmiatedActiveCases', data: value
      }));
    }

    window.onload = function main() {
      var sql = new cartodb.SQL({ user: 'joinzoe', api_key: 'N6sTD5Jriyd5fxO8Y19Dzw' });
      // Get total symptomatic
      sql.execute("SELECT SUM(prevalence_map.corrected_covid_positive) FROM prevalence_map")
        .done(function (data) {
          $syCases = data.rows[0]['sum'];
          $syCases = numberWithCommas(Math.round($syCases));
          setEstmiatedActiveCases($syCases);
        })
        .error(function (errors) {
          console.log("errors:" + errors);
        });
    }
  </script>

</body>

</html>